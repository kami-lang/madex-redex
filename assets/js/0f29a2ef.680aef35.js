"use strict";(self.webpackChunkstaticdocs_starter=self.webpackChunkstaticdocs_starter||[]).push([[8390],{44395:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"getting_started/usage","title":"Usage","description":"Basic Usage","source":"@site/docs/getting_started/usage.md","sourceDirName":"getting_started","slug":"/getting_started/usage","permalink":"/docs/getting_started/usage","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"usage","title":"Usage","sidebar_position":4},"sidebar":"mySidebar","previous":{"title":"Passes","permalink":"/docs/getting_started/passes"},"next":{"title":"Using ProGuard Rules with Redex","permalink":"/docs/examples/proguard"}}');var i=t(74848),a=t(28453);const r={id:"usage",title:"Usage",sidebar_position:4},o=void 0,d={},p=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"Tracing",id:"tracing",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(n.p,{children:"To use ReDex, first build your app and find the APK for it.  Then the simplest\ninvocation is:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[python3] redex.py path/to/your.apk -o path/to/output.apk\n"})}),"\n",(0,i.jsx)(n.p,{children:"A more complete invocation with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["the default configuration setting ",(0,i.jsx)(n.a,{href:"https://github.com/facebook/redex/blob/master/config/default.config",children:"config/default.config"})]}),"\n",(0,i.jsx)(n.li,{children:"access to the Android SDK tools"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[python3] redex.py -c default.config \\\n  --android-sdk-path path/to/android/sdk \\\n  path/to/your.apk -o path/to/output.apk\n"})}),"\n",(0,i.jsx)(n.p,{children:"The full set of options can be found with"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[python3] redex.py --help\n"})}),"\n",(0,i.jsx)(n.p,{children:"and at the time of writing is"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"usage: redex.py [-h] [-o [OUT]] [-j JARPATHS] [--redex-binary [REDEX_BINARY]]\n                [-c CONFIG] [--sign] [-s [KEYSTORE]] [-a [KEYALIAS]]\n                [-p [KEYPASS]] [-u] [--unpack-dest UNPACK_DEST] [-w [WARN]]\n                [-d] [--dev] [-m [PROGUARD_MAP]] [--printseeds [PRINTSEEDS]]\n                [--used-js-assets USED_JS_ASSETS] [-P PROGUARD_CONFIGS]\n                [-k [KEEP]] [-A [ARCH]] [-S PASSTHRU] [-J PASSTHRU_JSON]\n                [--lldb] [--gdb] [--ignore-zipalign] [--verify-none-mode]\n                [--enable-instrument-pass] [--is-art-build] [--enable-pgi]\n                [--post-lowering] [--disable-dex-hasher] [--page-align-libs]\n                [--side-effect-summaries SIDE_EFFECT_SUMMARIES]\n                [--escape-summaries ESCAPE_SUMMARIES] [--stop-pass STOP_PASS]\n                [--output-ir OUTPUT_IR]\n                [--debug-source-root [DEBUG_SOURCE_ROOT]] [--always-clean-up]\n                [--cmd-prefix CMD_PREFIX] [--reset-zip-timestamps] [-q]\n                [--android-sdk-path ANDROID_SDK_PATH]\n                input_apk\n\nGiven an APK, produce a better APK!\n\npositional arguments:\n  input_apk             Input APK file\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -o [OUT], --out [OUT]\n                        Output APK file name (defaults to redex-out.apk)\n  -j JARPATHS, --jarpath JARPATHS\n                        Path to dependent library jar file\n  --redex-binary [REDEX_BINARY]\n                        Path to redex binary\n  -c CONFIG, --config CONFIG\n                        Configuration file\n  --sign, --no-sign     Sign the apk after optimizing it\n  -s [KEYSTORE], --keystore [KEYSTORE]\n  -a [KEYALIAS], --keyalias [KEYALIAS]\n  -p [KEYPASS], --keypass [KEYPASS]\n  -u, --unpack-only     Unpack the apk and print the unpacked directories,\n                        don't run any redex passes or repack the apk\n  --unpack-dest UNPACK_DEST\n                        Specify the base name of the destination directories;\n                        works with -u\n  -w [WARN], --warn [WARN]\n                        Control verbosity of warnings\n  -d, --debug           Unpack the apk and print the redex command line to run\n  --dev                 Optimize for development speed\n  -m [PROGUARD_MAP], --proguard-map [PROGUARD_MAP]\n                        Path to proguard mapping.txt for deobfuscating names\n  --printseeds [PRINTSEEDS]\n                        File to print seeds to\n  --used-js-assets USED_JS_ASSETS\n                        A JSON file (or files) containing a list of resources\n                        used by JS\n  -P PROGUARD_CONFIGS, --proguard-config PROGUARD_CONFIGS\n                        Path to proguard config\n  -k [KEEP], --keep [KEEP]\n                        [deprecated] Path to file containing classes to keep\n  -A [ARCH], --arch [ARCH]\n                        Architecture; one of arm/armv7/arm64/x86_64/x86\"\n  -S PASSTHRU           Arguments passed through to redex\n  -J PASSTHRU_JSON      JSON-formatted arguments passed through to redex\n  --lldb                Run redex binary in lldb\n  --gdb                 Run redex binary in gdb\n  --ignore-zipalign     Ignore if zipalign is not found\n  --verify-none-mode    Enable verify-none mode on redex\n  --enable-instrument-pass\n                        Enable InstrumentPass if any\n  --is-art-build        States that this is an art only build\n  --enable-pgi          If not passed, Profile Guided Inlining is disabled\n  --post-lowering       Specifies whether post lowering steps should be run\n  --disable-dex-hasher  Disable DexHasher\n  --page-align-libs     Preserve 4k page alignment for uncompressed libs\n  --side-effect-summaries SIDE_EFFECT_SUMMARIES\n                        Side effect information for external methods\n  --escape-summaries ESCAPE_SUMMARIES\n                        Escape information for external methods\n  --stop-pass STOP_PASS\n                        Stop before a pass and dump intermediate dex and IR\n                        meta data to a directory\n  --output-ir OUTPUT_IR\n                        Stop before stop_pass and dump intermediate dex and IR\n                        meta data to output_ir folder\n  --debug-source-root [DEBUG_SOURCE_ROOT]\n                        Root directory that all references to source files in\n                        debug information is given relative to.\n  --always-clean-up     Clean up temporaries even under failure\n  --cmd-prefix CMD_PREFIX\n                        Prefix redex-all with\n  --reset-zip-timestamps\n                        Reset zip timestamps for deterministic output\n  -q, --quiet           Do not be verbose, and override TRACE.\n  --android-sdk-path ANDROID_SDK_PATH\n                        Path to Android SDK\n"})}),"\n",(0,i.jsxs)(n.p,{children:["From here, you may want to read the ",(0,i.jsx)(n.a,{href:"/docs/getting_started/configuring",children:"configuration guide"})," and details\nabout the ",(0,i.jsx)(n.a,{href:"/docs/getting_started/passes",children:"passes"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The result ",(0,i.jsx)(n.code,{children:"output.apk"})," should be smaller and faster than the\ninput."]}),"\n",(0,i.jsx)(n.h2,{id:"tracing",children:"Tracing"}),"\n",(0,i.jsx)(n.p,{children:"If you want some statistics about each pass, you can turn on tracing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"export TRACE=1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["More specifically, tracing has ",(0,i.jsx)(n.a,{href:"https://github.com/facebook/redex/blob/c5d5651b8b3ae9fda7b3305de9f55e1b82077a2d/libredex/Trace.h#L20",children:"categories"}),"\nand levels. For a ",(0,i.jsx)(n.code,{children:"TRACE(X, Y, msg)"})," statement in the code to be logged,\ncategory ",(0,i.jsx)(n.code,{children:"X"})," must have level ",(0,i.jsx)(n.code,{children:"Y"})," or higher:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"export TRACE=X:1,Y:2,Z:3\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The output of tracing can also be redirected to a file with the ",(0,i.jsx)(n.code,{children:"TRACEFILE"}),"\nvariable:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"export TRACEFILE=/path/to/trace.txt\n"})})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);